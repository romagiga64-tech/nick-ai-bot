<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NickAI Control</title>
    <style>
        body { font-family: sans-serif; background: #121212; color: #e0e0e0; text-align: center; padding: 20px; }
        .card { background: #1e1e1e; padding: 20px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.5); }
        .status { padding: 15px; border-radius: 10px; margin: 20px 0; font-weight: bold; text-transform: uppercase; }
        .online { background: #2e7d32; color: #fff; }
        .offline { background: #c62828; color: #fff; }
        button { width: 100%; padding: 15px; font-size: 18px; font-weight: bold; cursor: pointer; border-radius: 10px; border: none; background: #0288d1; color: white; transition: 0.3s; }
        #log { text-align: left; background: #000; padding: 10px; height: 200px; overflow-y: auto; font-family: monospace; font-size: 12px; margin-top: 20px; border-radius: 5px; border: 1px solid #333; }
    </style>
</head>
<body>
    <div class="card">
        <h1>ü§ñ NickAI Bot</h1>
        <div id="statusBox" class="status offline">–°—Ç–∞—Ç—É—Å: –ü–∞—É–∑–∞</div>
        <button id="startBtn">–ó–ê–ü–£–°–¢–ò–¢–¨ –°–ï–†–í–ï–†</button>
        <div id="log">–û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞...</div>
    </div>

    <script>
        // –¢–í–û–ò –î–ê–ù–ù–´–ï (–ö–ª—é—á OpenRouter —è —É–∂–µ –≤—Å—Ç–∞–≤–∏–ª)
        const TG_TOKEN = '–í–°–¢–ê–í–¨_–°–Æ–î–ê_–¢–û–ö–ï–ù_–û–¢_BOTFATHER'; 
        const AI_KEY = 'Sk-or-v1-c7eefcdf4a790f68757cb147ea7d150d596f8d3f0f7865906f54437cb38484ad';
        
        let isRunning = false;
        let lastUpdateId = 0;
        const logBox = document.getElementById('log');

        function addLog(text) {
            const entry = document.createElement('div');
            entry.innerText = `[${new Date().toLocaleTimeString()}] ${text}`;
            logBox.appendChild(entry);
            logBox.scrollTop = logBox.scrollHeight;
        }

        async function checkUpdates() {
            if (!isRunning) return;
            try {
                const response = await fetch(`https://api.telegram.org/bot${TG_TOKEN}/getUpdates?offset=${lastUpdateId + 1}&timeout=20`);
                const data = await response.json();
                if (data.ok && data.result.length > 0) {
                    for (const update of data.result) {
                        lastUpdateId = update.update_id;
                        if (update.message && update.message.text) {
                            addLog(`üì© –°–æ–æ–±—â–µ–Ω–∏–µ: ${update.message.text}`);
                            processAI(update.message.chat.id, update.message.text);
                        }
                    }
                }
            } catch (e) { console.error(e); }
            setTimeout(checkUpdates, 1000);
        }

        async function processAI(chatId, userText) {
            try {
                const aiRes = await fetch("https://openrouter.ai/api/v1/chat/completions", {
                    method: "POST",
                    headers: {
                        "Authorization": `Bearer ${AI_KEY}`,
                        "Content-Type": "application/json",
                        "HTTP-Referer": window.location.href,
                        "X-Title": "NickAI Bot"
                    },
                    body: JSON.stringify({
                        model: "google/gemini-2.0-flash-exp:free",
                        messages: [{ role: "user", content: userText }]
                    })
                });
                const aiData = await aiRes.json();
                const text = aiData.choices[0].message.content;

                await fetch(`https://api.telegram.org/bot${TG_TOKEN}/sendMessage`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ chat_id: chatId, text: text })
                });
                addLog('‚úÖ –û—Ç–≤–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω');
            } catch (e) { addLog('‚ùå –û—à–∏–±–∫–∞ AI'); }
        }

        document.getElementById('startBtn').onclick = function() {
            if (!isRunning) {
                if(TG_TOKEN.includes('–í–°–¢–ê–í–¨')) { 
                    alert('–¢—ã –∑–∞–±—ã–ª –≤—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–∫–µ–Ω –æ—Ç BotFather!'); 
                    return; 
                }
                isRunning = true;
                this.innerText = "–û–°–¢–ê–ù–û–í–ò–¢–¨ –ë–û–¢–ê";
                document.getElementById('statusBox').className = "status online";
                document.getElementById('statusBox').innerText = "–°—Ç–∞—Ç—É—Å: –†–ê–ë–û–¢–ê–ï–¢";
                addLog("üöÄ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω!");
                checkUpdates();
            } else { location.reload(); }
        };
    </script>
</body>
</html>
