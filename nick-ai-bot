<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NickAI Bot Control</title>
    <style>
        body { font-family: sans-serif; background: #121212; color: white; text-align: center; padding: 20px; }
        .status { padding: 15px; margin: 20px; border-radius: 10px; background: #222; border: 1px solid #333; }
        .on { color: #00ff00; font-weight: bold; } .off { color: #ff4444; font-weight: bold; }
        button { padding: 15px 30px; font-size: 18px; cursor: pointer; border: none; border-radius: 5px; background: #007bff; color: white; transition: 0.3s; }
        button:hover { background: #0056b3; }
        #logs { text-align: left; background: #000; padding: 15px; height: 250px; overflow-y: auto; margin-top: 20px; font-size: 13px; border-radius: 5px; border: 1px solid #444; color: #aaa; }
    </style>
</head>
<body>
    <h1>ü§ñ NickAI Bot Control</h1>
    
    <div class="status">
        –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–∞: <span id="statusText" class="off">–í–´–ö–õ–Æ–ß–ï–ù</span>
    </div>

    <button id="startBtn">–ó–ê–ü–£–°–¢–ò–¢–¨ –°–ï–†–í–ï–†</button>

    <div id="logs">–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∑–∞–ø—É—Å–∫—É...</div>

    <script>
        // –¢–í–û–ò –ö–õ–Æ–ß–ò
        const TELEGRAM_TOKEN = '8518635440:AAGf1dCV1gj6W0jOXuhK3BqtzOVseLxMwBc';
        const OPENROUTER_KEY = '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'; 

        let offset = 0;
        let isRunning = false;

        const log = (msg) => {
            const div = document.createElement('div');
            div.textContent = `[${new Date().toLocaleTimeString()}] ${msg}`;
            document.getElementById('logs').prepend(div);
        };

        async function getUpdates() {
            if (!isRunning) return;
            try {
                const response = await fetch(`https://api.telegram.org/bot${TELEGRAM_TOKEN}/getUpdates?offset=${offset}&timeout=30`);
                const data = await response.json();
                if (data.result) {
                    for (const update of data.result) {
                        offset = update.update_id + 1;
                        if (update.message) handleMessage(update.message);
                    }
                }
            } catch (e) { log('–ü–æ–∏—Å–∫ —Å–æ–æ–±—â–µ–Ω–∏–π...'); }
            getUpdates();
        }

        async function handleMessage(msg) {
            log(`–°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç ${msg.from.first_name}: ${msg.text}`);
            
            try {
                const response = await fetch("https://openrouter.ai/api/v1/chat/completions", {
                    method: "POST",
                    headers: {
                        "Authorization": `Bearer ${OPENROUTER_KEY}`,
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({
                        model: "google/gemini-flash-1.5-exp",
                        messages: [{ role: "user", content: msg.text }]
                    })
                });
                const data = await response.json();
                const aiReply = data.choices[0].message.content;

                await fetch(`https://api.telegram.org/bot${TELEGRAM_TOKEN}/sendMessage`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ chat_id: msg.chat.id, text: aiReply })
                });
                log(`–û—Ç–≤–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ Telegram! ‚úÖ`);
            } catch (e) { log('–û—à–∏–±–∫–∞! –ü—Ä–æ–≤–µ—Ä—å –∫–ª—é—á–∏.'); }
        }

        document.getElementById('startBtn').onclick = () => {
            isRunning = !isRunning;
            document.getElementById('statusText').textContent = isRunning ? '–†–ê–ë–û–¢–ê–ï–¢' : '–í–´–ö–õ–Æ–ß–ï–ù';
            document.getElementById('statusText').className = isRunning ? 'on' : 'off';
            document.getElementById('startBtn').textContent = isRunning ? '–û–°–¢–ê–ù–û–í–ò–¢–¨' : '–ó–ê–ü–£–°–¢–ò–¢–¨ –°–ï–†–í–ï–†';
            if (isRunning) { log('–ë–æ—Ç –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!'); getUpdates(); }
        };
    </script>
</body>
</html>
